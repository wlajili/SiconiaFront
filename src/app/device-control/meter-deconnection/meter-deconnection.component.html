
<div class="container py-5" >
    <div class="card">
        <div class="card-header"> 
            <h4>Déconnection d'un compteur</h4>
        </div>
        <div class="form-inline p-3" *ngIf="message">
            <div class="col-3"> </div>
            <div class="col-6">
                <ngb-alert class = "center-block" [type]="type" 
                (close)="message = null">{{ message }}</ngb-alert>
            </div>
        </div>
      <form [formGroup]="deconnectionForm" action="" (ngSubmit)="onSubmit()">
      <div class="card-body">
          <div class="form-group">
            <label for="idCompteur" class="control-label col-sm-2">Compteur :</label>
            <div class="col-sm-5">
                <div class="input-group">
                    <input type="text" id="idCompteur" formControlName= "idCompteur"
                    class="form-control" [class.is-invalid]="searchFailed" 
                     [ngbTypeahead]="search">
                    <span *ngIf="searching">searching...</span>
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary loop"  type="button" ></button>
                    </div>
                </div> 
                <div class="alert alert-danger" *ngIf="searchFailed">Sorry, suggestions could not be loaded.</div>
                  <div *ngIf="errors.idCompteur"  class="alert alert-danger">
                    <div *ngIf="errors.idCompteur">
                        {{errors.idCompteur}}
                    </div>
                  </div>    
            </div>
            <div class="form-horizontal" [ngbCollapse]="isCompteurIdVide">
                <br>
                <div class="form-inline">
                    <div class="form-group col-md-2">
                        <label class="control-label ">idType:</label>
                    </div>
                    <div class="form-group col-md-4">
                        <span >{{compteur?.idType}} </span>
                    </div>
                    <div class="form-group col-md-2">
                        <label class="control-label ">modelNumber:</label>
                    </div>
                    <div class="form-group col-md-4">
                        <span >{{compteur?.modelNumber}} </span>
                    </div>
                </div>
                <div class="form-inline">
                    <div class="form-group col-md-2">
                        <label class="control-label ">pathName:</label>
                    </div>
                    <div class="form-group col-md-4">
                        <span >{{compteur?.pathName}} </span>
                    </div>
                    <div class="form-group col-md-2">
                        <label class="control-label ">serialNumber:</label>
                    </div>
                    <div class="form-group col-md-4">
                        <span >{{compteur?.serialNumber}} </span>
                    </div>
                </div>
            </div>
          </div>
          <hr/>
          <div class="form-group">
              <label for="priorityId" class="control-label col-sm-2">Priorité :</label>
              <div class="col-sm-5">
                  <select class="form-control"  id="priorityId" formControlName="requestPriority">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                  </select>
                  <div *ngIf="errors.requestPriority"  class="alert alert-danger">
                    <div *ngIf="errors.requestPriority">
                        {{errors.requestPriority}}
                    </div>
                </div>    
              </div>
          </div>
          <hr/>
          <div class="form-group">
              <div class="row col-sm-12">
                  <div class="col-md-4">
                      <label for="startTimeId" class="control-label ">Start time:</label>
                      <div class="form-inline">
                          <div class="form-group">
                              <div class="input-group">
                              <input id="startTimeId" class="form-control" formControlName="startDate" placeholder="yyyy-mm-dd" ngbDatepicker #d1="ngbDatepicker" >
                              <div class="input-group-append">
                                  <button class="btn btn-outline-secondary calendar" (click)="d1.toggle();" type="button"></button>
                              </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="col-md-8 mb-3">
                      <ngb-timepicker formControlName="startTime" [seconds] = "true" ></ngb-timepicker>
                  </div>
                  <div *ngIf="errors.startDate || errors.startTime"  class="alert alert-danger">
                      <div *ngIf="errors.startDate">
                        {{errors.startDate}}
                      </div>
                      <div *ngIf="errors.startTime">
                        {{errors.startTime}}
                      </div>
                  </div>   
              </div>
          </div>
          <hr/>
          <div class="form-group">
              <div class="row col-sm-12">
                  <div class="col-md-4">
                      <label for="exireTimeId" class="control-label ">Expire time:</label>
                      <div class="form-inline">
                          <div class="form-group">
                              <div class="input-group">
                              <input id="expireTimeId" class="form-control" formControlName="expireDate" placeholder="yyyy-mm-dd" ngbDatepicker #d2="ngbDatepicker" >
                              <div class="input-group-append">
                                  <button class="btn btn-outline-secondary calendar" (click)="d2.toggle();" type="button"></button>
                              </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="col-md-8 mb-3">
                      <ngb-timepicker formControlName="expireTime" [seconds] = "true" ></ngb-timepicker>
                  </div>
                  <div *ngIf="errors.expireDate || errors.expireTime"  class="alert alert-danger">
                      <div *ngIf="errors.expireDate">
                        {{errors.expireDate}}
                      </div>
                      <div *ngIf="errors.expireTime">
                        {{errors.expireTime}}
                      </div>
                  </div>   
              </div>
          </div>
          <hr/>
          <div class="form-group">
            <div class="col-sm-2"></div>
            <button class="btn btn-primary" type="submit" [disabled]="deconnectionForm.invalid || attenteRetourSubmit">Valider</button>
        </div>          
      </div>
    </form>
  </div>
</div>